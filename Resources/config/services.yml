imports:
    - { resource: handlers/legacy.yml }

parameters:
    netgen_information_collection.controller.full.class: Netgen\Bundle\InformationCollectionBundle\Controller\FullViewController
    netgen_information_collection.form.builder.class: Netgen\Bundle\InformationCollectionBundle\Form\Builder\FormBuilder

    # Doctrine parameteters for information collection
    netgen_information_collection.repository.ez_info_collection.class: Netgen\Bundle\InformationCollectionBundle\Repository\EzInfoCollectionRepository
    netgen_information_collection.entity.ez_info_collection.class: Netgen\Bundle\InformationCollectionBundle\Entity\EzInfoCollection
    netgen_information_collection.repository.ez_info_collection_attribute.class: Netgen\Bundle\InformationCollectionBundle\Repository\EzInfoCollectionAttributeRepository
    netgen_information_collection.entity.ez_info_collection_attribute.class: Netgen\Bundle\InformationCollectionBundle\Entity\EzInfoCollectionAttribute
    # END of Doctrine parameters

    netgen_information_collection.action.aggregate.class: Netgen\Bundle\InformationCollectionBundle\Action\ActionAggregate
    netgen_information_collection.action.db.class: Netgen\Bundle\InformationCollectionBundle\Action\PersistToDatabaseAction
    netgen_information_collection.action.email.class: Netgen\Bundle\InformationCollectionBundle\Action\SendEmailAction

    netgen_information_collection.listener.class: Netgen\Bundle\InformationCollectionBundle\Listener\InformationCollectedListener

    netgen_information_collection.field_handler.legacy.registry.class: Netgen\Bundle\InformationCollectionBundle\FieldHandler\Legacy\Registry\FieldHandlerRegistry
services:
    netgen_information_collection.controller.full:
        class: '%netgen_information_collection.controller.full.class%'
        arguments:
            - '@netgen_information_collection.form.builder'
            - '@event_dispatcher'

    netgen_information_collection.form.builder:
        class: '%netgen_information_collection.form.builder.class%'
        arguments:
            - '@form.factory'
            - '@ezpublish.api.service.content_type'
            - '%netgen_information_collection.form.use_csrf%'

    # Info collection repositories
    netgen_information_collection.repository.ez_info_collection:
        class: "%netgen_information_collection.repository.ez_info_collection.class%"
        factory: ["@doctrine.orm.entity_manager", getRepository]
        arguments: [ "%netgen_information_collection.entity.ez_info_collection.class%" ]

    netgen_information_collection.repository.ez_info_collection_attribute:
        class: "%netgen_information_collection.repository.ez_info_collection_attribute.class%"
        factory: ["@doctrine.orm.entity_manager", getRepository]
        arguments: [ "%netgen_information_collection.entity.ez_info_collection_attribute.class%" ]
    # END of Info collection repositories

    netgen_information_collection.action.aggregate:
        class: '%netgen_information_collection.action.aggregate.class%'

    netgen_information_collection.action.db:
        class: '%netgen_information_collection.action.db.class%'
        arguments:
            - '@netgen_information_collection.field_handler.legacy.registry'
            - '@netgen_information_collection.repository.ez_info_collection'
            - '@netgen_information_collection.repository.ez_info_collection_attribute'
            - '@ezpublish.api.repository'
        tags:
            - { name: netgen_information_collection.action }

    netgen_information_collection.action.email:
        class: '%netgen_information_collection.action.email.class%'
        tags:
            - { name: netgen_information_collection.action }

    netgen_information_collection.listener:
        class: '%netgen_information_collection.listener.class%'
        arguments:
            - '@netgen_information_collection.action.aggregate'
        tags:
            - { name: kernel.event_subscriber }

    netgen_information_collection.field_handler.legacy.registry:
        class: '%netgen_information_collection.field_handler.legacy.registry.class%'