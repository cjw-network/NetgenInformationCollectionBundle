imports:
    - { resource: actions.yml }
    - { resource: core/persistence.yml }
    - { resource: factories.yml }
    - { resource: legacy_handlers.yml }
    - { resource: admin.yml }
    - { resource: anonymizers.yml }
    - { resource: ezplatform_admin.yml }

parameters:

services:
    netgen_information_collection.form.builder:
        class: Netgen\InformationCollection\Form\Builder\FormBuilder
        public: true
        arguments:
            - '@form.factory'
            - '@ezpublish.api.service.content_type'

    netgen_information_collection.listener:
        class: Netgen\InformationCollection\Listener\InformationCollectedListener
        arguments:
            - '@netgen_information_collection.action.registry'
        tags:
            - { name: kernel.event_subscriber }

    netgen_information_collection.field_handler.registry:
        class: Netgen\InformationCollection\Core\Persistence\FieldHandler\FieldHandlerRegistry
        arguments:
            - !tagged_iterator netgen_information_collection.field_handler.custom

    netgen_information_collection.mailer:
        class: Netgen\InformationCollection\Core\Mailer\Mailer
        arguments:
            - '@mailer'

    netgen_information_collection.form.extension.field_definition:
        class: Netgen\InformationCollection\Integration\RepositoryForms\FieldDefinitionTypeExtension
        tags:
            - { name: form.type_extension, extended_type: EzSystems\EzPlatformAdminUi\Form\Type\FieldDefinition\FieldDefinitionType }

    netgen_information_collection.domain_object_mapper:
        class: Netgen\InformationCollection\Core\Mapper\DomainObjectMapper
        arguments:
            - '@ezpublish.api.repository'


    netgen_information_collection.twig.extension.rendering:
        class: Netgen\InformationCollection\Templating\Twig\Extensions\FieldRenderingExtension
        public: false
        tags:
            - { name: twig.extension }

    netgen_information_collection.twig.runtime.rendering:
        class: Netgen\InformationCollection\Templating\Twig\Extensions\FieldRenderingRuntime
        # public: false
        arguments:
            - '@twig'
            - '@ezpublish.config.resolver'
        tags:
            - { name: twig.runtime }

    netgen_information_collection.form.information_collection_type:
        class: Netgen\InformationCollection\Integration\RepositoryForms\InformationCollectionType
        tags:
            - { name: form.type }

    netgen_information_collection.form.information_collection_field_type:
        class: Netgen\InformationCollection\Integration\RepositoryForms\InformationCollectionFieldType
        arguments:
            - "@ezplatform.content_forms.field_type_form_mapper.dispatcher"
        tags:
            - { name: form.type }
